# Лабораторная работа №6 `98252`
Выполнил: **Дорохин Сергей Константинович `группа: P3111`** \
Преподаватель: **Саржвеский Иван Анатольевич**

------------
### Условие
По выданному преподавателем варианту разработать и исследовать работу комплекса программ обмена данными в режиме
прерывания программы. Основная программа должна изменять содержимое заданной ячейки памяти (Х), которое должно быть
представлено как знаковое число. Область допустимых значений изменения Х должна быть ограничена заданной функцией F(X) и
конструктивными особенностями регистра данных ВУ (8-ми битное знаковое представление). Программа обработки прерывания
должна выводить на ВУ модифицированное значение Х в соответствии с вариантом задания, а также игнорировать все
необрабатываемые прерывания.

------------
### Задания варианта
* Основная программа должна увеличивать на 2 содержимое X (ячейки памяти с адресом $011_{16}$) в цикле.
*  Обработчик прерывания должен по нажатию кнопки готовности ВУ-1 осуществлять вывод результата вычисления функции $F(X)=2X+1$ на данное ВУ, a по нажатию кнопки готовности ВУ-2 вычесть утроенное содержимое РД данного ВУ из Х, результат записать в X
* Если Х оказывается вне ОДЗ при выполнении любой операции по его изменению, то необходимо в Х записать минимальное по ОДЗ число.

------------
### ОДЗ

$-128 \leq 2x+1 \leq 127 \Rightarrow -127 \leq 2x \leq 128 \Rightarrow -63.5 \leq x \leq 64 \Rightarrow -63 \leq x \leq 64$

$63 = \textbf{0x003F}$
&
$64 = \textbf{0x0040}$
&
$-63 = 1111.1111.1100.0001 = \textbf{0xFFC1} $

Таким образом, число X лежит в диапазоне **[FFC1; 0040]**

------------

### Расположение данных в памяти

------------

### Текст программы

```asm
ORG 0x0
V0:	WORD $DEFAULT, 0x180
V1:	WORD $INT1, 0x180
V2:	WORD $INT2, 0x180
V3:	WORD $DEFAULT, 0x180
V4:	WORD $DEFAULT, 0x180
V5:	WORD $DEFAULT, 0x180
V6:	WORD $DEFAULT, 0x180
V7:	WORD $DEFAULT, 0x180
DEFAULT:	IRET

ORG 0x011
X: WORD 0x6
MAX: WORD 0x0040
MIN: WORD 0xFFC1

ORG 0x050
START:
		DI
		CLA
		call $LOCK_INT
		call $ALLOW_INT
		call $BODY

BODY:
		EI
		CLA

MAIN:
		DI
		LD X
		INC 
		INC
		CALL $CHECK
		ST X
		EI
		JUMP MAIN

CHECK:
		check_min:
			NOP
			CMP MIN
			BPL check_max
			JUMP ld_min
		check_max:
			 CMP MAX
			 BEQ return
			 BMI return
		 ld_min: LD MIN
		 return: RET

; разрешить прерывания и вектор №1 & №2
ALLOW_INT:
		LD #9 ;  №1
		OUT 3 ; (1001) в MR КВУ-1
		LD #0xA ; 
		OUT 5 ; (1010) в MR КВУ-2
		RET

; запрет прерываний для неиспользуемых ВУ
LOCK_INT:
		OUT 0x1
	  	OUT 0x7
		OUT 0xB
		OUT 0xD
		OUT 0x11
		OUT 0x15
		OUT 0x19
		OUT 0x1D
		RET

INT1:
		HLT
		LD X
		NEG
		ASL
		ASL
		SUB X
		SUB #4
		OUT 2
		HLT
		IRET

INT2:	
		PUSH
		HLT
		IN 4
		OR X
		ST X
		HLT
		POP
		IRET

```

------------

